<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>HTML Panels Tips: #6 integrating Topcoat CSS | Davide Barranca &mdash; Photoshop, etc. </title>
    <meta property="og:title" content="HTML Panels Tips: #6 integrating Topcoat CSS | Davide Barranca &mdash; Photoshop, etc. " />
    <meta name="twitter:title" content="HTML Panels Tips: #6 integrating Topcoat CSS | Davide Barranca &mdash; Photoshop, etc. " />

    <meta name="description" content="How to integrate the Adobe Topcoat CSS library with Theme management for HTML Panels in Photoshop CC">
    <meta name="description" property="og:description" content="How to integrate the Adobe Topcoat CSS library with Theme management for HTML Panels in Photoshop CC" />
    <meta name="twitter:description" content="How to integrate the Adobe Topcoat CSS library with Theme management for HTML Panels in Photoshop CC" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@undavide" />
    
    <meta property="og:url" content="http://localhost:4000/2014/02/html-panels-tips-6-integrating-topcoat-css/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Davide Barranca" />

    <meta name="copyright" content="Copyright by Davide Barranca. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

    <link rel="canonical" href="http://localhost:4000/2014/02/html-panels-tips-6-integrating-topcoat-css/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    

    
    <script>
      function UnCryptMailto(s) {
        var n = 0;
        var r = "";
        for (var i = 0; i < s.length; i++) {
          n = s.charCodeAt(i);
          if (n >= 8364) {
            n = 128;
          }
          r += String.fromCharCode(n - 1);
        }
        return r;
      }

      function linkTo_UnCryptMailto(s) {
        location.href = UnCryptMailto(s);
      }
    </script>
    
</head>


    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://localhost:4000"><img alt="Avatar" src="/assets/img/io.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Davide Barranca</strong>
            <span class="my-job-title">Photoshop, etc.</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://localhost:4000" >Blog</a>
            
                
            
                
            
                
            
                
                    <a href="http://localhost:4000/courses/" >Courses</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">Digital Caveman. Photoshop retoucher and script/panels developer. I also publish courses, check the Books page!</p>

    <ul class="socials">
        <li><a href="https://www.facebook.com/undavide"><svg title="facebook" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li><li><a href="https://twitter.com/undavide"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://github.com/undavide"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <!-- WAS: <a href="mailto:davide.barranca@gmail.com">  -->
            <li><a href="javascript:linkTo_UnCryptMailto('nbjmup;ebwjef/cbssbodbAhnbjm/dpn');" title="Drop me an email"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://localhost:4000/feed.xml"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-02-02T16:27:01+01:00" itemprop="datePublished">2 Feb, 2014</time></li>
            
                
                <li class="cats">
                    
                        <a href="/categories/CEP/">CEP</a>
                    
                </li>
                
            
        </ul>
        <h2 itemprop="name headline">HTML Panels Tips: #6 integrating Topcoat CSS</h2>
    </header>

    <div class="post-content">
        <p>Today’s tip is about integration of the Topcoat CSS library with <code class="highlighter-rouge">themeManager.js</code> in Photoshop HTML Panels. Adobe’s <a href="http://topcoat.io" title="Topcoat">Topcoat</a> is:</p>

<blockquote>
  <p>a brand new open source CSS library designed to help developers build web apps with an emphasis on speed. It evolved from the Adobe design language developed for Brackets, Edge Reflow, and feedback from the PhoneGap app developer community.</p>
</blockquote>

<p>It comes with <a href="http://topcoat.io/topcoat/index.html" title="Topcoat Desktop theme">Desktop</a> and <a href="http://topcoat.io/topcoat/topcoat-mobile-dark.html" title="Topcoat Mobile theme">Mobile</a> themes, both in Light of Dark shades - a really neat design. HTML Panels have <em>sort of</em> a built-in system to keep in sync with Photoshop interface (four shades, from light gray to black). I’ve said “sort of” because you need to explicitly set the functions, but they’re provided by default by both Extension Builder and <a href="http://davidderaedt.github.io/ccext-website/" title="CC Extensibility Helpers">boilerplate code</a> by <a href="https://twitter.com/davidderaedt" title="David Deraedt on Twitter">David Deraedt</a>. Basically it’s a matter of triggering some styling when the PS Interface changes - you do this listening for the <code class="highlighter-rouge">CSInterface.THEME_COLOR_CHANGED_EVENT</code>:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// themeManager.js</span>

<span class="kd">function</span> <span class="nx">updateThemeWithAppSkinInfo</span><span class="p">(</span><span class="nx">appSkinInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ... All styling stuff here</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">onAppThemeColorChanged</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">skinInfo</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">__adobe_cep__</span><span class="p">.</span><span class="nx">getHostEnvironment</span><span class="p">()).</span><span class="nx">appSkinInfo</span><span class="p">;</span>
  <span class="nx">updateThemeWithAppSkinInfo</span><span class="p">(</span><span class="nx">skinInfo</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">csInterface</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSInterface</span><span class="p">();</span>
  <span class="nx">updateThemeWithAppSkinInfo</span><span class="p">(</span><span class="nx">csInterface</span><span class="p">.</span><span class="nx">hostEnvironment</span><span class="p">.</span><span class="nx">appSkinInfo</span><span class="p">);</span>
  <span class="nx">csInterface</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">CSInterface</span><span class="p">.</span><span class="nx">THEME_COLOR_CHANGED_EVENT</span><span class="p">,</span> <span class="nx">onAppThemeColorChanged</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p><img src="/wp-content/uploads/2014/02/hostObject.png" alt="hostObject" /></p>

<p>The above code first runs <code class="highlighter-rouge">updateThemeWithAppSkinInfo()</code>, (the function that performs the actual styling - changes CSS rules, etc)  passing as a parameter an <code class="highlighter-rouge">appSkinInfo</code> object. It contains various host environment (i.e. Photoshop) information, as the screenshot from the Chrome Developer Tools console shows on the right. Depending on these values, you might decide for instance to change the background of your HTML Panel to match the Photoshop own <code class="highlighter-rouge">panelBackgroundColor</code> (or font size, color, whatever).</p>

<p>Please note: Topcoat already comes in two flavors (Light and Dark) so you can always decide to switch to the corresponding CSS depending on the Photoshop’s interface color. You’d pick Topcoat’s Light for the PS LigthGray and MidGray, and Topcoat’s Dark for the PS DarkGray and Black interface. I personally don’t like this option. Topcoat’s background color doesn’t match with Photoshop (I admit I’m a bit picky on this - after all we’re adapting a library that’s not been built for this very purpose). Let’s call 1, 2, 3, 4 the PS interface shades: Topcoat Dark is too light for 1 and too dark for 2, while Topcoat Light is too light for 3 and too dark for 4. I’ll show you in the following example how to better integrate the two systems.</p>

<h2 id="example">Example</h2>

<p>As I’m compiling these tips while I discover new things working on actual projects, so I’ll show you as the example a simple panel I’m currently porting to HTML (called <a href="/2013/10/introducing-ps-projects-for-photoshop-cc-cs6/">PS Projects</a>).</p>

<h3 id="html">HTML</h3>

<p>The code here is really basic - I don’t need anything fancy but three buttons: I’ve set a <strong>Large Button Bar</strong> using a snippet from Topcoat examples. As you can see, I’ve set IDs for the stylesheets - the reason is going to be clear soon.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">id=</span><span class="s">"hostStyle"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/theme.css"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;link</span> <span class="na">id=</span><span class="s">"theme"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/light.css"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;title&gt;&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"center"</span><span class="nt">&gt;</span>PS Projects 2.0<span class="nt">&lt;/h3&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"topcoat-button-bar"</span> <span class="na">style=</span><span class="s">"margin-left:20px"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"topcoat-button-bar__item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"create"</span> <span class="na">class=</span><span class="s">"topcoat-button-bar__button--large"</span><span class="nt">&gt;</span>Create New<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"topcoat-button-bar__item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"load"</span> <span class="na">class=</span><span class="s">"topcoat-button-bar__button--large"</span><span class="nt">&gt;</span>Load...<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"topcoat-button-bar__item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"modify"</span> <span class="na">class=</span><span class="s">"topcoat-button-bar__button--large"</span><span class="nt">&gt;</span>Modify...<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>          

  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/libs/CSInterface-4.0.0.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/libs/jquery-2.0.2.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/themeManager.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/main.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<h3 id="javascript">Javascript</h3>

<p>The main.js contains (besides stuff I need for JSX operations - the actual routines of my panel) a call to <code class="highlighter-rouge">themeManager.init()</code>. The <code class="highlighter-rouge">themeManager.js</code> is as follows:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">themeManager</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="s1">'use strict'</span><span class="p">;</span>

  <span class="c1">//Convert the Color object to string in hexadecimal format;</span>
  <span class="kd">function</span> <span class="nx">toHex</span><span class="p">(</span><span class="nx">color</span><span class="p">,</span> <span class="nx">delta</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">computeValue</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delta</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">computedValue</span> <span class="o">=</span> <span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">delta</span><span class="p">)</span> <span class="p">?</span> <span class="nx">value</span> <span class="o">+</span> <span class="nx">delta</span> <span class="p">:</span> <span class="nx">value</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">computedValue</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">computedValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">computedValue</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">computedValue</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
      <span class="p">}</span>            
      <span class="nx">computedValue</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">computedValue</span><span class="p">);</span>
      <span class="nx">computedValue</span> <span class="o">=</span> <span class="nx">computedValue</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">computedValue</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span> <span class="p">?</span> <span class="s2">"0"</span> <span class="o">+</span> <span class="nx">computedValue</span> <span class="p">:</span> <span class="nx">computedValue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">hex</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">hex</span> <span class="o">=</span> <span class="nx">computeValue</span><span class="p">(</span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span><span class="p">,</span> <span class="nx">delta</span><span class="p">)</span> <span class="o">+</span> <span class="nx">computeValue</span><span class="p">(</span><span class="nx">color</span><span class="p">.</span><span class="nx">green</span><span class="p">,</span> <span class="nx">delta</span><span class="p">)</span> <span class="o">+</span> <span class="nx">computeValue</span><span class="p">(</span><span class="nx">color</span><span class="p">.</span><span class="nx">blue</span><span class="p">,</span> <span class="nx">delta</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">hex</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">addRule</span><span class="p">(</span><span class="nx">stylesheetId</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">rule</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">stylesheet</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">stylesheetId</span><span class="p">);</span>   
    <span class="k">if</span> <span class="p">(</span><span class="nx">stylesheet</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">stylesheet</span> <span class="o">=</span> <span class="nx">stylesheet</span><span class="p">.</span><span class="nx">sheet</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">stylesheet</span><span class="p">.</span><span class="nx">addRule</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stylesheet</span><span class="p">.</span><span class="nx">addRule</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">rule</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">stylesheet</span><span class="p">.</span><span class="nx">insertRule</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stylesheet</span><span class="p">.</span><span class="nx">insertRule</span><span class="p">(</span><span class="nx">selector</span> <span class="o">+</span> <span class="s1">' { '</span> <span class="o">+</span> <span class="nx">rule</span> <span class="o">+</span> <span class="s1">' }'</span><span class="p">,</span> <span class="nx">stylesheet</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">//Update the theme with the AppSkinInfo retrieved from the host product.</span>
  <span class="kd">function</span> <span class="nx">updateThemeWithAppSkinInfo</span><span class="p">(</span><span class="nx">appSkinInfo</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// console.log(appSkinInfo)</span>
    <span class="kd">var</span> <span class="nx">panelBgColor</span> <span class="o">=</span> <span class="nx">appSkinInfo</span><span class="p">.</span><span class="nx">panelBackgroundColor</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bgdColor</span> <span class="o">=</span> <span class="nx">toHex</span><span class="p">(</span><span class="nx">panelBgColor</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">fontColor</span> <span class="o">=</span> <span class="s2">"F0F0F0"</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">panelBgColor</span><span class="p">.</span><span class="nx">red</span> <span class="o">&gt;</span> <span class="mi">122</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fontColor</span> <span class="o">=</span> <span class="s2">"000000"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">styleId</span> <span class="o">=</span> <span class="s2">"hostStyle"</span><span class="p">;</span>
    <span class="nx">addRule</span><span class="p">(</span><span class="nx">styleId</span><span class="p">,</span> <span class="s2">"body"</span><span class="p">,</span> <span class="s2">"background-color:"</span> <span class="o">+</span> <span class="s2">"#"</span> <span class="o">+</span> <span class="nx">bgdColor</span><span class="p">);</span>
    <span class="nx">addRule</span><span class="p">(</span><span class="nx">styleId</span><span class="p">,</span> <span class="s2">"body"</span><span class="p">,</span> <span class="s2">"color:"</span> <span class="o">+</span> <span class="s2">"#"</span> <span class="o">+</span> <span class="nx">fontColor</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">isLight</span> <span class="o">=</span> <span class="nx">appSkinInfo</span><span class="p">.</span><span class="nx">panelBackgroundColor</span><span class="p">.</span><span class="nx">color</span><span class="p">.</span><span class="nx">red</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isLight</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">"#theme"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"href"</span><span class="p">,</span> <span class="s2">"css/light.css"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s2">"#theme"</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"href"</span><span class="p">,</span> <span class="s2">"css/dark.css"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">onAppThemeColorChanged</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">skinInfo</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">__adobe_cep__</span><span class="p">.</span><span class="nx">getHostEnvironment</span><span class="p">()).</span><span class="nx">appSkinInfo</span><span class="p">;</span>
    <span class="nx">updateThemeWithAppSkinInfo</span><span class="p">(</span><span class="nx">skinInfo</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>   
    <span class="kd">var</span> <span class="nx">csInterface</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSInterface</span><span class="p">();</span>
    <span class="nx">updateThemeWithAppSkinInfo</span><span class="p">(</span><span class="nx">csInterface</span><span class="p">.</span><span class="nx">hostEnvironment</span><span class="p">.</span><span class="nx">appSkinInfo</span><span class="p">);</span>
    <span class="nx">csInterface</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">CSInterface</span><span class="p">.</span><span class="nx">THEME_COLOR_CHANGED_EVENT</span><span class="p">,</span> <span class="nx">onAppThemeColorChanged</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">init</span><span class="p">:</span> <span class="nx">init</span>
  <span class="p">};</span>

<span class="p">}());</span></code></pre></figure>

<p>The <code class="highlighter-rouge">toHex()</code> and <code class="highlighter-rouge">addRule()</code> are utility functions, while <code class="highlighter-rouge">init()</code> (orders the styling update and adds a theme change event listener) and <code class="highlighter-rouge">onAppThemeColorChanged()</code> (retrieves the AppSkinInfo object and pass it forwards) are the same as in the first code chunk, up in the page. <code class="highlighter-rouge">updateThemeWithAppSkinInfo()</code> extracts from the <code class="highlighter-rouge">AppSkinInfo</code> object the panels background color and set new <code class="highlighter-rouge">background-color</code> and <code class="highlighter-rouge">color</code> rules in the stylesheet with <code class="highlighter-rouge">id="hostStyle"</code>. Then, depending on the Red component of the background color (an arbitrary choice) it determines whether the interface <code class="highlighter-rouge">isLight</code> or not, and load a dark or light Topcoat CSS using jQuery.</p>

<h3 id="css">CSS</h3>

<p>The HTML loads two CSS files, even if the panel deals with a total of three. The one with <code class="highlighter-rouge">id="hostStyle"</code> is <strong>theme.css</strong> and contains  minor tweaks - it’s the target of the <code class="highlighter-rouge">addRule()</code> function, which will add there <code class="highlighter-rouge">background-color</code> and <code class="highlighter-rouge">color</code> rules depending on the PS interface theme (lightGray, darkGray, etc). Then there’s <code class="highlighter-rouge">dark.css</code> and <code class="highlighter-rouge">light.css</code> - which are the original <code class="highlighter-rouge">topcoat-desktop-dark.css</code> and <code class="highlighter-rouge">topcoat-desktop-light.css</code> renamed. In order not to conflict with styles set via <code class="highlighter-rouge">themeManager.js</code> I’ve commented out some bits in the body section of both of them:</p>

<figure class="highlight"><pre><code class="language-css" data-lang="css"><span class="c">/* dark.css and light.css */</span>
<span class="nt">body</span> <span class="p">{</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="c">/*background: #4b4d4e;
  color: #000;*/</span>
  <span class="nl">font</span><span class="p">:</span> <span class="m">16px</span> <span class="s1">"Source Sans"</span><span class="p">,</span> <span class="n">helvetica</span><span class="p">,</span> <span class="n">arial</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
  <span class="nl">font-weight</span><span class="p">:</span> <span class="m">400</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">//</span> <span class="o">...</span></code></pre></figure>

<p>As a result I’ve made the two Topcoat Dark and Light versions synchronize with the exact background-color and color.</p>

<p><img src="/wp-content/uploads/2014/02/Topcoat.png" alt="Topcoat" /></p>

<hr />

<h3 id="the-photoshop-html-panels-development-course">The Photoshop HTML Panels Development Course</h3>

<figure class="alignleft">
  <a href="https://htmlpanelsbook.com" target="_blank">
	<img src="/wp-content/uploads/2016/03/BookVideo.jpg" alt="Photoshop HTML Panels Development course" /></a>
	<figcaption>Updated to CC 2019.</figcaption>
</figure>

<p>If you’re reading here, you might be interested in my Photoshop Panels development – so let me inform you that I’ve authored a full course:</p>

<ul>
  <li><strong>300 pages</strong> PDF</li>
  <li><strong>3 hours</strong> of HD screencasts</li>
  <li><strong>28 custom Panels</strong> with commented code</li>
</ul>

<p><a href="http://htmlpanelsbook.com">Check it out!</a> Please help me spread the news – I’ll be able to keep producing more exclusive content on this blog. Thank you!</p>


    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=HTML Panels Tips: #6 integrating Topcoat CSS&p[summary]=Today’s tip is about integration of the Topcoat CSS library with themeManager.js in Photoshop HTML Panels. Adobe’s Topcoat is:


  a bran...&p[url]=http://localhost:4000/2014/02/html-panels-tips-6-integrating-topcoat-css/" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://localhost:4000/2014/02/html-panels-tips-6-integrating-topcoat-css/&text=Today’s tip is about integration of the Topcoat CSS library with themeManager.js in Photoshop HTML Panels. Adobe’s Topcoat is:


  a bran...&hashtags=HTML Panels Tips," rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
                <li><a href="http://localhost:4000/tag/HTML Panels Tips">HTML Panels Tips</a></li>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'http://localhost:4000/2014/02/html-panels-tips-6-integrating-topcoat-css/';
            this.page.identifier = '2/2/2014';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//davidebarranca.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>


            </main>
        </div>

        <script src="http://localhost:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://localhost:4000/assets/js/backtotop.js"></script>
<script src="http://localhost:4000/assets/js/lunr.min.js"></script>
<script src="http://localhost:4000/assets/js/lunr-feed.js"></script>
<script src="http://localhost:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://localhost:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://localhost:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-25716894-1', 'auto');
        ga('send', 'pageview');
    </script>

    </body>
</html>