<!DOCTYPE html>
<html>
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>HTML Panels Tips: #7 Photoshop Events, Take 1 | Davide Barranca &mdash; Photoshop, etc. </title>

  <!-- ORIGINAL THEME SOCIAL META  start -->
  <!-- <meta property="og:title" content="HTML Panels Tips: #7 Photoshop Events, Take 1 | Davide Barranca &mdash; Photoshop, etc. " />

    <meta name="twitter:title" content="HTML Panels Tips: #7 Photoshop Events, Take 1 | Davide Barranca &mdash; Photoshop, etc. " />

    <meta name="description" content="The first way for an HTML Panel to listen for Photoshop Events: PhotoshopRegisterEvent and PhotoshopCallback">

    <meta name="description" property="og:description" content="The first way for an HTML Panel to listen for Photoshop Events: PhotoshopRegisterEvent and PhotoshopCallback" />
    <meta name="twitter:description" content="The first way for an HTML Panel to listen for Photoshop Events: PhotoshopRegisterEvent and PhotoshopCallback" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@undavide" />
    
    <meta property="og:url" content="http://localhost:4000/2014/02/html-panels-tips-7-events-photoshopregisterevent-photoshopcallback/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" /> -->

  <!-- ORIGINAL THEME SOCIAL META  end -->

  <!-- MY OWN SOCIAL META  start -->

  <meta name="twitter:site" content="@undavide">
  <meta name="twitter:creator" content="@undavide">
  <meta name="twitter:title" content="HTML Panels Tips: #7 Photoshop Events, Take 1">

  <meta property="og:url" content="http://localhost:4000/2014/02/html-panels-tips-7-events-photoshopregisterevent-photoshopcallback/" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="HTML Panels Tips: #7 Photoshop Events, Take 1 | Davide Barranca" />

  
  <meta name="twitter:description" content="This tip shows you the first way to make an HTML Panel listen and react to Photoshop Events: via PhotoshopRegisterEvent. Back in the Flash land, there were two ways to register callbacks for Photos...">
  <meta property="og:description" content="This tip shows you the first way to make an HTML Panel listen and react to Photoshop Events: via PhotoshopRegisterEvent. Back in the Flash land, there were two ways to register callbacks for Photos...">
  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="/wp-content/uploads/2014/02/PSEvents1.png">
  <meta property="og:image" content="http://localhost:4000/wp-content/uploads/2014/02/PSEvents1.png" />
  

<!-- media_card recommended size: 1200 x 628 -->
  <!-- MY OWN SOCIAL META  end -->


  <meta name="author" content="Davide Barranca" />

  <meta name="copyright" content="Copyright by Davide Barranca. All Rights Reserved." />

  <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
  
  <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  
  <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

  <link rel="canonical" href="http://localhost:4000/2014/02/html-panels-tips-7-events-photoshopregisterevent-photoshopcallback/">

  <link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

  

  
  <script>
    function UnCryptMailto(s) {
      var n = 0;
      var r = "";
      for (var i = 0; i < s.length; i++) {
        n = s.charCodeAt(i);
        if (n >= 8364) {
          n = 128;
        }
        r += String.fromCharCode(n - 1);
      }
      return r;
    }

    function linkTo_UnCryptMailto(s) {
      location.href = UnCryptMailto(s);
    }
  </script>
  
</head>


    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://localhost:4000"><img alt="Avatar" src="/assets/img/io.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Davide Barranca</strong>
            <span class="my-job-title">Photoshop, etc.</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://localhost:4000" >Blog</a>
            
                
            
                
            
                
            
                
                    <a href="http://localhost:4000/courses/" >Courses</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">Digital Caveman. Photoshop retoucher and script/panels developer. I am also an author, check the Courses page!</p>

    <ul class="socials">
        <li><a href="https://www.facebook.com/undavide"><svg title="facebook" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li><li><a href="https://twitter.com/undavide"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://github.com/undavide"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <!-- WAS: <a href="mailto:davide.barranca@gmail.com">  -->
            <li><a href="javascript:linkTo_UnCryptMailto('nbjmup;ebwjef/cbssbodbAhnbjm/dpn');" title="Drop me an email"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://localhost:4000/feed.xml"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-02-07T16:22:18+01:00" itemprop="datePublished">7 Feb, 2014</time></li>
            
                
                <li class="cats">
                    
                        <a href="/categories/CEP/">CEP</a>
                    
                </li>
                
            
        </ul>
        <h2 itemprop="name headline">HTML Panels Tips: #7 Photoshop Events, Take 1</h2>
    </header>

    <div class="post-content">
        <p>This tip shows you the first way to make an HTML Panel listen and react to Photoshop Events: via <code class="highlighter-rouge">PhotoshopRegisterEvent</code>. Back in the Flash land, there were <strong>two ways</strong> to register callbacks for Photoshop Events: using either a <strong>PSHosttAdapter</strong> library, or an <strong>ExternalInterface</strong> object and PhotoshopCallback. Today’s tip is about the latter (see <a href="/2014/02/html-panels-tips-8-photoshop-events-pshostadapter-libraries/" title="HTML Panels Tips: #8 Photoshop Events, Take 2">Tip #8</a> for the PSHostAdapter libraries). What we used to write in <strong>ActionScript</strong> was something like:</p>

<figure class="highlight"><pre><code class="language-as" data-lang="as"><span class="c1">// Set TypeID for desired events</span>
<span class="kr">private</span> <span class="kr">const</span> <span class="nx">COPY_INT</span><span class="o">:</span><span class="nx">int</span> <span class="o">=</span> <span class="nx">Photoshop</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">charIDToTypeID</span><span class="p">(</span><span class="err">’</span><span class="nx">copy</span><span class="err">’</span><span class="p">)</span><span class="o">;</span>
<span class="kr">private</span> <span class="kr">const</span> <span class="nx">PASTE_INT</span><span class="o">:</span><span class="nx">int</span> <span class="o">=</span> <span class="nx">Photoshop</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">charIDToTypeID</span><span class="p">(</span><span class="err">’</span><span class="nx">past</span><span class="err">’</span><span class="p">)</span><span class="o">;</span>

<span class="c1">// Register for events</span>
<span class="nx">CSInterface</span><span class="p">.</span><span class="nx">PhotoshopRegisterEvent</span><span class="p">(</span><span class="nx">COPY_INT</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="nx">PASTE_INT</span><span class="p">)</span><span class="o">;</span>
<span class="c1">// attach a callback</span>
<span class="nx">ExternalInterface</span><span class="p">.</span><span class="nx">addCallback</span><span class="p">(</span><span class="s2">"PhotoshopCallback"</span> <span class="o">+</span> <span class="nx">CSInterface</span><span class="p">.</span><span class="nx">getExtensionId</span><span class="p">(),</span> <span class="nx">myPhotoshopCallback</span><span class="p">)</span><span class="o">;</span>
<span class="c1">// Define the callback</span>
<span class="kr">private</span> <span class="kd">function</span> <span class="nx">myPhotoshopCallback</span><span class="p">(</span><span class="nx">eventID</span><span class="o">:</span><span class="nx">Number</span><span class="p">,</span> <span class="nx">descID</span><span class="o">:</span><span class="nx">Number</span><span class="p">)</span><span class="o">:</span><span class="nb">void</span> <span class="p">{</span>
<span class="c1">//</span>
<span class="p">}</span></code></pre></figure>

<p>Things are slightly different now in <strong>Javascript</strong>. and are based on <code class="highlighter-rouge">CSInterface</code> and the dispatching of a custom Event. As follows the mechanism in a nutshell, then I’ll show you an actual example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">csInterface</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSInterface</span><span class="p">();</span>

<span class="c1">// Create a new Event</span>
<span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSEvent</span><span class="p">(</span><span class="s2">"com.adobe.PhotoshopRegisterEvent"</span><span class="p">,</span> <span class="s2">"APPLICATION"</span><span class="p">);</span>

<span class="c1">// Set Event properties: extension id</span>
<span class="nx">event</span><span class="p">.</span><span class="nx">extensionId</span> <span class="o">=</span> <span class="s2">"com.example.psevents"</span><span class="p">;</span>

<span class="c1">// Set Event properties: data (as Type ID string, comma separated)</span>
<span class="c1">// 1668247673 = charIDToTypeID( "copy" ) = copy</span>
<span class="c1">// 1885434740 = charIDToTypeID( "past" ) = paste</span>
<span class="c1">// 1668641824 = charIDToTypeID( "cut " ) = cut</span>
<span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="s2">"1668247673, 1885434740, 1668641824"</span><span class="p">;</span>

<span class="c1">// Dispatch the Event</span>
<span class="nx">csInterface</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>

<span class="c1">// Attach a callback</span>
<span class="nx">csInterface</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"PhotoshopCallback"</span><span class="p">,</span> <span class="nx">PSCallback</span><span class="p">);</span>

<span class="c1">// Define the callback</span>
<span class="kd">function</span> <span class="nx">PSCallback</span><span class="p">(</span><span class="nx">csEvent</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span></code></pre></figure>

<h2 id="example">Example</h2>

<p><img src="/wp-content/uploads/2014/02/PSEvents1.png" alt="PSEvents" /></p>

<p>This Panel has a switch to turn ON/OFF the listener for few PS Events (cut, copy, paste). When the listener is active and the user cuts, copies or pastes, the Event’s StringID is written in the text area. In case you need a refresh of HTML Panels related topics to go through this one, here’s the <a href="/category/code/html-panels/" title="HTML Panels Tips">whole list</a>. You might need a refresh because this example uses Topcoat CSS (see <a href="/2014/02/html-panels-tips-6-integrating-topcoat-css/" title="HTML Panels Tips: #6 integrating Topcoat CSS">HTML Panels Tip #6</a>) and communication between HTML and JSX (<a href="/2014/01/html-panels-tips-4-passing-objects-from-html-to-jsx/" title="HTML Panels Tips: #4 passing Objects from HTML to JSX">Tip #4</a>).</p>

<h3 id="html">HTML</h3>

<p>The Panel uses <a href="http://davidderaedt.github.io/ccext-website/" title="CC Extensibility Helpers">boilerplate code</a> by <a href="https://twitter.com/davidderaedt" title="David Deraedt on Twitter">David Deraedt</a> with the addition of Topcoat CSS (refer to <a href="/2014/02/html-panels-tips-6-integrating-topcoat-css/" title="HTML Panels Tips: #6 integrating Topcoat CSS">HTML Panels Tip #6</a> for the details). I’ve set up a Topcoat Switch and a Text Area:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;!</span><span class="nx">doctype</span> <span class="nx">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"hostStyle"</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"css/theme.css"</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"theme"</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"css/light.css"</span> <span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;&lt;</span><span class="sr">/title</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/head</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=</span><span class="s2">"width: 80%; margin:0 auto"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">h3</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"center"</span><span class="o">&gt;</span><span class="nx">PS</span> <span class="nx">Events</span><span class="o">&lt;</span><span class="sr">/h3</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">label</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"topcoat-switch"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"registerEvent"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"checkbox"</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"topcoat-switch__input"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"topcoat-switch__toggle"</span><span class="o">&gt;&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"result"</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"topcoat-text-input"</span> <span class="nx">style</span><span class="o">=</span><span class="s2">"margin-left:10px"</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Listen for Events"</span> <span class="nx">value</span><span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
  <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"js/libs/CSInterface-4.0.0.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"js/libs/jquery-2.0.2.min.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"js/themeManager.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"js/main.js"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="sr">/body</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="sr">/html&gt;</span></code></pre></figure>

<h3 id="javascript">Javascript</h3>

<p>In <code class="highlighter-rouge">main.js</code> it’s defined the Register() function that attaches (or remove) the listener, dispatching a CSEvent as you’ve already seen. A jQuery function binds the switch to <code class="highlighter-rouge">Register()</code> and finally a <code class="highlighter-rouge">PSCallback</code> function is defined: there, the Event data String is split and passed for evaluation to JSX (see <a href="/2014/01/html-panels-tips-4-passing-objects-from-html-to-jsx/" title="HTML Panels Tips: #4 passing Objects from HTML to JSX">Tip #4</a> for details about HTML to JSX data exchange). The <code class="highlighter-rouge">evalScript</code> callback (that is, the JSX return value) is displayed in the Text Area.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="s1">'use strict'</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">csInterface</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSInterface</span><span class="p">();</span>

  <span class="kd">function</span> <span class="nx">Register</span><span class="p">(</span><span class="nx">inOn</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inOn</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSEvent</span><span class="p">(</span><span class="s2">"com.adobe.PhotoshopRegisterEvent"</span><span class="p">,</span> <span class="s2">"APPLICATION"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSEvent</span><span class="p">(</span><span class="s2">"com.adobe.PhotoshopUnRegisterEvent"</span><span class="p">,</span> <span class="s2">"APPLICATION"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">extensionId</span> <span class="o">=</span> <span class="s2">"com.example.psevents"</span><span class="p">;</span>

    <span class="c1">// some events:</span>
    <span class="c1">// 1668247673 = charIDToTypeID( "copy" ) = copy</span>
    <span class="c1">// 1885434740 = charIDToTypeID( "past" ) = paste</span>
    <span class="c1">// 1668641824 = charIDToTypeID( "cut " ) = cut</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="s2">"1668247673, 1885434740, 1668641824"</span><span class="p">;</span>
    <span class="nx">csInterface</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">themeManager</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>

    <span class="c1">// Switch onChange callback</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'#registerEvent'</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Register</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">is</span><span class="p">(</span><span class="s1">':checked'</span><span class="p">));</span> <span class="c1">// true or false</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">PSCallback</span><span class="p">(</span><span class="nx">csEvent</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dataArray</span> <span class="o">=</span> <span class="nx">csEvent</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">","</span><span class="p">);</span>
    <span class="c1">// send to JSX to convert typeIDs to stringIDs</span>
    <span class="nx">csInterface</span><span class="p">.</span><span class="nx">evalScript</span><span class="p">(</span><span class="s1">'convertTypeID('</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">dataArray</span><span class="err">\</span><span class="p">[</span><span class="mi">0</span><span class="err">\</span><span class="p">])</span> <span class="o">+</span> <span class="s1">')'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">'#result'</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="nx">init</span><span class="p">();</span>
  <span class="nx">csInterface</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"PhotoshopCallback"</span><span class="p">,</span> <span class="nx">PSCallback</span><span class="p">);</span>

<span class="p">}());</span></code></pre></figure>

<h3 id="jsx">JSX</h3>

<p>In the JSX file there’s just a function, that converts the TypeID to StringID and returns it.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">convertTypeID</span> <span class="p">(</span><span class="nx">typeArray</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">typeIDToStringID</span><span class="p">(</span><span class="nb">Number</span><span class="p">(</span><span class="nx">typeArray</span><span class="p">));</span>
<span class="p">}</span></code></pre></figure>

<hr />

<h3 id="the-photoshop-html-panels-development-course">The Photoshop HTML Panels Development Course</h3>

<figure class="alignleft">
  <a href="https://htmlpanelsbook.com" target="_blank">
	<img src="/wp-content/uploads/2016/03/BookVideo.jpg" alt="Photoshop HTML Panels Development course" /></a>
	<figcaption>Updated to CC 2019.</figcaption>
</figure>

<p>If you’re reading here, you might be interested in my Photoshop Panels development – so let me inform you that I’ve authored a full course:</p>

<ul>
  <li><strong>300 pages</strong> PDF</li>
  <li><strong>3 hours</strong> of HD screencasts</li>
  <li><strong>28 custom Panels</strong> with commented code</li>
</ul>

<p><a href="http://htmlpanelsbook.com">Check it out!</a> Please help me spread the news – I’ll be able to keep producing more exclusive content on this blog. Thank you!</p>


    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=HTML Panels Tips: #7 Photoshop Events, Take 1&p[summary]=This tip shows you the first way to make an HTML Panel listen and react to Photoshop Events: via PhotoshopRegisterEvent. Back in the Flas...&p[url]=http://localhost:4000/2014/02/html-panels-tips-7-events-photoshopregisterevent-photoshopcallback/" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://localhost:4000/2014/02/html-panels-tips-7-events-photoshopregisterevent-photoshopcallback/&text=This tip shows you the first way to make an HTML Panel listen and react to Photoshop Events: via PhotoshopRegisterEvent. Back in the Flas...&hashtags=HTML Panels Tips," rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
                <li><a href="http://localhost:4000/tag/HTML Panels Tips">HTML Panels Tips</a></li>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'http://localhost:4000/2014/02/html-panels-tips-7-events-photoshopregisterevent-photoshopcallback/';
            this.page.identifier = '2/7/2014';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//davidebarranca.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>


            </main>
        </div>

        <script src="http://localhost:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://localhost:4000/assets/js/backtotop.js"></script>
<script src="http://localhost:4000/assets/js/lunr.min.js"></script>
<script src="http://localhost:4000/assets/js/lunr-feed.js"></script>
<script src="http://localhost:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://localhost:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://localhost:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-25716894-1', 'auto');
        ga('send', 'pageview');
    </script>


 <script id="dsq-count-scr" src="//davidebarranca.disqus.com/count.js" async></script>

    </body>
</html>