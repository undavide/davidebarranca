<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>CryptoJS Tutorial For Dummies | Davide Barranca &mdash; Photoshop, etc. </title>
    <meta property="og:title" content="CryptoJS Tutorial For Dummies | Davide Barranca &mdash; Photoshop, etc. " />
    <meta name="twitter:title" content="CryptoJS Tutorial For Dummies | Davide Barranca &mdash; Photoshop, etc. " />

    <meta name="description" content="CryptoJS basic tutorial and practical tips. How to implement in your Extendscript / Javascript code this great free Cryptography library.">
    <meta name="description" property="og:description" content="CryptoJS basic tutorial and practical tips. How to implement in your Extendscript / Javascript code this great free Cryptography library." />
    <meta name="twitter:description" content="CryptoJS basic tutorial and practical tips. How to implement in your Extendscript / Javascript code this great free Cryptography library." />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@undavide" />
    
    <meta property="og:url" content="http://localhost:4000/2012/10/crypto-js-tutorial-cryptography-for-dummies/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Davide Barranca" />

    <meta name="copyright" content="Copyright by Davide Barranca. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

    <link rel="canonical" href="http://localhost:4000/2012/10/crypto-js-tutorial-cryptography-for-dummies/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    

    
    <script>
      function UnCryptMailto(s) {
        var n = 0;
        var r = "";
        for (var i = 0; i < s.length; i++) {
          n = s.charCodeAt(i);
          if (n >= 8364) {
            n = 128;
          }
          r += String.fromCharCode(n - 1);
        }
        return r;
      }

      function linkTo_UnCryptMailto(s) {
        location.href = UnCryptMailto(s);
      }
    </script>
    
</head>


    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://localhost:4000"><img alt="Avatar" src="/assets/img/io.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Davide Barranca</strong>
            <span class="my-job-title">Photoshop, etc.</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://localhost:4000" >Blog</a>
            
                
            
                
            
                
            
                
                    <a href="http://localhost:4000/courses/" >Courses</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">Digital Caveman. Photoshop retoucher and script/panels developer. I am also an author, check the Courses page!</p>

    <ul class="socials">
        <li><a href="https://www.facebook.com/undavide"><svg title="facebook" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li><li><a href="https://twitter.com/undavide"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://github.com/undavide"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <!-- WAS: <a href="mailto:davide.barranca@gmail.com">  -->
            <li><a href="javascript:linkTo_UnCryptMailto('nbjmup;ebwjef/cbssbodbAhnbjm/dpn');" title="Drop me an email"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://localhost:4000/feed.xml"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-10-14T02:30:15+02:00" itemprop="datePublished">14 Oct, 2012</time></li>
            
                
                <li class="cats">
                    
                        <a href="/categories/Scripting/">Scripting</a>
                    
                </li>
                
            
        </ul>
        <h2 itemprop="name headline">CryptoJS Tutorial For Dummies</h2>
    </header>

    <div class="post-content">
        <p><em>[Updated October 16th 2012 with corrected information from CryptoJS author Jeff Mott - look for the <strong>UPDATED</strong> tag below]</em><br />
The Google Code <a href="http://code.google.com/p/crypto-js" title="Crypto JS home page">Crypto-JS</a> page titles “<em>JavaScript implementations of standard and secure cryptographic algorithms</em>” and that’s exactly what it’s all about. I strongly suggest you to read the <a href="http://code.google.com/p/crypto-js/#Quick-start_Guide" title="CryptoJS Quick Start Guide">QuickStart Guide</a>: this CryptoJS Tutorial for Dummies is just made with comments in the margin of it - underlining important stuff I didn’t notice when I first approached it. The official documentation is precise yet kind of succint - it makes sense to those who master the topic, but it may disorient the newcomers (like me when I get there for the first time). I’m just on my way learning both cryptography theory and this nice JS library, the following is only a collection of basic advices and personal notes. Please forgive me for using a very… non-specialized jargon.</p>

<blockquote>
  <p><em>Caveat</em>: I use to write code in <strong>Extendscript</strong> - which is an Adobe made superset of Javascript adding nice extras, such as: file-system access, user interface development tools, external communication, preprocessing directives, XML integration, etc. I say so because it seems that my mindset is a bit shifted from the one of the pure Javascript developer (for instance, I’ve not to worry about privacy issues arising from readable code - my .jsx files are binary encrypted by default when I export them from the ESTK - ExtendScript ToolKit). I use to write <a href="http://coffeescript.org" title="Coffeescript home page">Coffeescript</a>, a nice smart language that compiles to Javascript, but I won’t us it here. Lot of extra resources on the Coffeescript language <a href="http://wiht.link/CoffeeScript">here</a>.</p>
</blockquote>

<h2 id="files">Files</h2>

<p>First, <a href="http://code.google.com/p/crypto-js/downloads/list" title="Crypto JS download page">download</a> the CryptoJS package (3.0.2 at the time of this post). It contains two folders:</p>

<ul>
  <li><strong>components</strong> - with both minified and commented JS files.</li>
  <li><strong>rollups</strong> - minified files (one for each algorithm) bundled with core code.</li>
</ul>

<p>Components files have dependencies: you have to link at least core.js, while rollups are quite self contained. In Extendscript, save a test.jsx file alongside (or within) the CryptoJS folder and set the preprocessing directives:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">#</span><span class="nx">include</span> <span class="s2">"components/core-min.js"</span>
<span class="err">#</span><span class="nx">include</span> <span class="s2">"rollups/sha1.js"</span>
<span class="err">#</span><span class="nx">include</span> <span class="s2">"rollups/aes.js"</span>
<span class="err">#</span><span class="nx">include</span> <span class="s2">"components/enc-base64-min.js"</span>
<span class="err">#</span><span class="nx">include</span> <span class="s2">"components/enc-utf16-min.js"</span></code></pre></figure>

<p>The #include (redundant here) are the equivalent of the following tag in HTML documents:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://crypto-js.googlecode.com/svn/tags/3.0.2/build/rollups/aes.js"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p>Be aware that you need to save the file at least once otherwise the include can’t resolve the path.</p>

<h2 id="word-array-and-encodings">Word Array and Encodings</h2>

<p>CryptoJS makes large use of Word Array - that is, arrays of 32-bits words (instances of the <code class="highlighter-rouge">CryptoJS.lib.WordArray</code>); few useful functions:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Creates a word array filled with random bytes.</span>
<span class="c1">// @param {number} nBytes The number of random bytes to generate.</span>
<span class="kd">var</span> <span class="nx">wordArray</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>

<span class="c1">// Converts a String to word array</span>
<span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">);</span>
<span class="c1">// 00480065006c006c006f002c00200057006f0072006c00640021</span>

<span class="c1">// Reverses the word array to a readable String</span>
<span class="kd">var</span> <span class="nx">utf8</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span> <span class="c1">// Hello World</span></code></pre></figure>

<p>Mind you, quoting the Guide: “<em>When you use a WordArray object in a string context</em>”, that is, an alert box or the Console, “<em>it’s automatically converted to a <strong>hex string</strong></em>”. CryptoJS can manage different encodings, such as Base64, Hex, Latin1, UTF-8 and UTF-16. If you wonder how data would look like converted to them, paste this script in ESTK (Adobe’s ExtendScriptToolKit):</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">#</span><span class="nx">include</span> <span class="s2">"components/enc-base64-min.js"</span>
<span class="err">#</span><span class="nx">include</span> <span class="s2">"components/enc-utf16-min.js"</span>

<span class="c1">// Save at least once in the appropriate folder in order to</span>
<span class="c1">// help the #include to resolve the path</span>

<span class="kd">var</span> <span class="nx">wordArray</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>
<span class="nx">alert</span><span class="p">(</span><span class="s2">"Random WordArray"</span> <span class="o">+</span><span class="s2">"</span><span class="err">\</span><span class="se">\n</span><span class="s2">Hex: "</span><span class="o">+</span> <span class="nx">wordArray</span> <span class="o">+</span> <span class="s2">"</span><span class="err">\</span><span class="se">\n</span><span class="err">\</span><span class="se">\n</span><span class="s2">Base 64: "</span> <span class="o">+</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">wordArray</span><span class="p">)</span> <span class="o">+</span><span class="s2">"</span><span class="err">\</span><span class="se">\n</span><span class="err">\</span><span class="se">\n</span><span class="s2">Latin 1: "</span> <span class="o">+</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Latin1</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">wordArray</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="err">\</span><span class="se">\n</span><span class="err">\</span><span class="se">\n</span><span class="s2">UTF-8: "</span> <span class="o">+</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf8</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">wordArray</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="err">\</span><span class="se">\n</span><span class="err">\</span><span class="se">\n</span><span class="s2">UTF-16: "</span> <span class="o">+</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">wordArray</span><span class="p">))</span></code></pre></figure>

<p>The output is as follows - I’ve used an Alert box because ESTK’s $.writeln() (as I suspect both console.log() and debug(), depending on the tool you use to run your JS code) can’t output but Hex and Base64:</p>

<p><img src="/wp-content/uploads/2012/10/DB_-2012-10-13-at-11.05.08.png" alt="ESTK output" title="ESTK output" /></p>

<h3 id="conversion-functions">Conversion Functions</h3>

<p>Include both <code class="highlighter-rouge">enc-base64-min.js</code> and <code class="highlighter-rouge">enc-utf16-min.js</code> in your code. The functions are in the form:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="o">/</span><span class="nx">Encoding</span><span class="o">/</span><span class="p">.</span><span class="nx">parse</span><span class="p">();</span>
<span class="c1">// interprets the param as /Encoded/												// and converts it to Word Array</span>

<span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="o">/</span><span class="nx">Encoding</span><span class="o">/</span><span class="p">.</span><span class="nx">stringify</span><span class="p">();</span>
<span class="c1">// interprets the param as Word Array												// and converts it to the /Encoded/ String</span>

<span class="kd">var</span> <span class="nx">wordArray</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">);</span> <span class="c1">// Word Array</span>
<span class="kd">var</span> <span class="nx">utf16</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">wordArray</span><span class="p">);</span> <span class="c1">// String</span></code></pre></figure>

<p>Few examples as follows:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Encodings:</span>
<span class="kd">var</span> <span class="nx">words</span>  <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'SGVsbG8sIFdvcmxkIQ=='</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">base64</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Latin1</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">latin1</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Latin1</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'48656c6c6f2c20576f726c6421'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">hex</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf8</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'♦'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">utf8</span>  <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf8</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">words</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">utf16</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf16</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span></code></pre></figure>

<h2 id="hash-functions">Hash Functions</h2>

<p>So to speak, <em>hashers</em> are functions that take an input (no matter how large) and maps it to a fixed size, smaller one (the hash, or checksum). You can’t convert a hash back to the original input, yet you can check if the original data has been corrupted comparing the hashes. CryptoJS implements MD5, SHA-1 (used by Git) and its variant (2, 224, 384, 256 and 512).</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">SHA1</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">);</span>
<span class="c1">// c4b0858dd7f14b154cac443b659bf9def034e01f</span></code></pre></figure>

<p>The input <code class="highlighter-rouge">"Message"</code> can either be a <em>WordArray</em> or a <em>String</em> (which will automatically be converted to the former, encoded UTF-8). Then you may:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// CONVERT WordArray to Latin1 or Base64 - better off using alert()!</span>
<span class="kd">var</span> <span class="nx">hash_Latin1</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Latin1</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">hash_Base64</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">);</span></code></pre></figure>

<p>Mind you the two forms are equivalent:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">hash_Base64</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">hash_Base64</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span></code></pre></figure>

<h2 id="ciphers">Ciphers</h2>

<p>CryptoJS implements several Cipher Algorithms - in the following example AES:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">#</span><span class="nx">include</span> <span class="s2">"rollups/aes.js"</span>

<span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">);</span>
<span class="c1">// AABsAABkAABiAAAAAAAAAABNAABlAABPAAC0AABHAAA=</span>

<span class="kd">var</span> <span class="nx">decrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">decrypted</span><span class="p">);</span>
<span class="c1">// 4d657373616765</span></code></pre></figure>

<p>The encryption results in a Base64 string, while the decrypted string is Hex. To get back the “Message” you need to:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">$</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">decrypted</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Utf8</span><span class="p">));</span>
<span class="c1">// Message</span></code></pre></figure>

<p>If you run the encryption code several times, you’ll notice that the result will change:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">);</span>
<span class="c1">// AABsAABkAAA0AAAAAAAAAABfAADSAAC5AABcAACjAAA=</span>

<span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">);</span>
<span class="c1">// AABsAABkAAA8AAAAAAAAAAA1AACIAAChAAAqAADMAAA=</span>

<span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">writeln</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">);</span>
<span class="c1">// AABsAABkAAArAAAAAAAAAAA4AABGAAAkAACpAAB5AAA=</span></code></pre></figure>

<p>yet each one of them will always decrypt to “Message”. How come?</p>

<h3 id="key-salt-and-initialization-vector">Key, Salt and Initialization Vector</h3>

<p>I’m not a cryptography expert - my raw understanding of the matter (after digging Wikipedia and StackOverflow) is as follows. Human memorizable passphrase are known to be bad ones. In order to make them more secure you can add a bunch of random bits (the <strong>salt</strong>) so that the actual <code class="highlighter-rouge">key = function(Salt, Passphrase)</code>. An effect of Salt is that the same passphrase doesn’t always produce the same key. IV (initialization vector) is used, similarly, to ensure that the same plaintext (“Message”) doesn’t return the same ciphertext. It appears that Salt is used with passphrase to generate a key for encryption, then the resulting encryption is processed with IV. So to speak, the <code class="highlighter-rouge">encryption = function(plaintext, passphrase, salt, IV)</code>. So when you write:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span></code></pre></figure>

<p>CryptoJS randomly generates for you what it need. [<strong>UPDATED</strong>] Alternatively, you can specify:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">iv</span>  <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="p">{</span> <span class="na">iv</span><span class="p">:</span> <span class="nx">iv</span> <span class="p">});</span>
<span class="kd">var</span> <span class="nx">decrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="p">{</span> <span class="na">iv</span><span class="p">:</span> <span class="nx">iv</span> <span class="p">});</span></code></pre></figure>

<h3 id="input-and-output">Input and output</h3>

<p>The encrypt function takes a plaintext input as a String or WordArray (the “Message”), and either a similar passphrase or Hex Key and IV. [<strong>UPDATED</strong>] It’s important to reaffirm that, if you use a String as a passphrase, CryptoJS uses it to generate a random key and IV:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span>
<span class="kd">var</span> <span class="nx">iv</span>  <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span>
<span class="c1">// WRONG!!</span>
<span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="p">{</span><span class="na">iv</span><span class="p">:</span> <span class="nx">iv</span><span class="p">});</span></code></pre></figure>

<p>The code above is <strong>not proper</strong>, for two reasons:</p>

<ol>
  <li>Key and IV are Strings, not Word Arrays!</li>
  <li>Consequently, the key is used as a String passphrase from which to derive a random <em>actual</em> key + IV pair - so they’re not the <code class="highlighter-rouge">key</code> and <code class="highlighter-rouge">iv</code> variables you’ve declared.</li>
</ol>

<p>When it comes to the output, things are a bit different because if you:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">alert</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">encrypted</span><span class="p">);</span> <span class="c1">// object</span></code></pre></figure>

<p>Actually, the encryption output is an object called <strong>CipherParams</strong>, and you can access its properties:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>

<span class="nx">alert</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">);</span> <span class="c1">// U2FsdGVkX1+iX5Ey7GqLND5UFUoV0b7rUJ2eEvHkYqA=</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span> <span class="c1">// 74eb593087a982e2a6f5dded54ecd96d1fd0f3d44a58728cdcd40c55227522223</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">.</span><span class="nx">iv</span><span class="p">);</span> <span class="c1">// 7781157e2629b094f0e3dd48c4d786115</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">.</span><span class="nx">salt</span><span class="p">);</span> <span class="c1">// 7a25f9132ec6a8b34</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">.</span><span class="nx">ciphertext</span><span class="p">);</span> <span class="c1">// 73e54154a15d1beeb509d9e12f1e462a0</span></code></pre></figure>

<p>I’ve had some troubles understanding why they use this object as the vector of encrypted data - the pack of bits you and the other guy oversea securely swap. It looks like you’re putting your treasure map into a casket and ship it with the keys to open it (I would have used the ciphertext only). It puzzled me because you can successfully write:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">decrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span> <span class="nx">encrypted</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="p">{</span> <span class="na">iv</span><span class="p">:</span> <span class="nx">encrypted</span><span class="p">.</span><span class="nx">iv</span><span class="p">});</span></code></pre></figure>

<p>[<strong>UPDATED</strong>] The explanation came directly from CryptoJS author Jeff Moss who wrote me:</p>

<blockquote>
  <p>Although the key is a property in the CipherParams object, the key is not included when that CipherParams object is serialized to a string. By default, CipherParams objects are serialized using a format from OpenSSL. Just do encrypted.toString(), and you can safely send that to the other side of the ocean.</p>
</blockquote>

<p>So the <code class="highlighter-rouge">alert(encrypted);</code> hex string you see in the last but one code block is definitely safe to use and share:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">"Message"</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">decrypted</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">AES</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span><span class="s2">"U2FsdGVkX1+iX5Ey7GqLND5UFUoV0b7rUJ2eEvHkYqA="</span><span class="p">,</span> <span class="s2">"Secret Passphrase"</span><span class="p">)</span> <span class="c1">// or just encrypted.toString()</span></code></pre></figure>

<p>There’s definitely more to dig in this great CryptoJS library, I’m looking forward to explore it! This should be just enough to let you start implementing cryptography in your own projects.</p>

    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=CryptoJS Tutorial For Dummies&p[summary]=[Updated October 16th 2012 with corrected information from CryptoJS author Jeff Mott - look for the UPDATED tag below]
The Google Code Cr...&p[url]=http://localhost:4000/2012/10/crypto-js-tutorial-cryptography-for-dummies/" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://localhost:4000/2012/10/crypto-js-tutorial-cryptography-for-dummies/&text=[Updated October 16th 2012 with corrected information from CryptoJS author Jeff Mott - look for the UPDATED tag below]
The Google Code Cr...&hashtags=Crypto-JS," rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
                <li><a href="http://localhost:4000/tag/Crypto-JS">Crypto-JS</a></li>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'http://localhost:4000/2012/10/crypto-js-tutorial-cryptography-for-dummies/';
            this.page.identifier = '10/14/2012';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//davidebarranca.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>


            </main>
        </div>

        <script src="http://localhost:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://localhost:4000/assets/js/backtotop.js"></script>
<script src="http://localhost:4000/assets/js/lunr.min.js"></script>
<script src="http://localhost:4000/assets/js/lunr-feed.js"></script>
<script src="http://localhost:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://localhost:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://localhost:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-25716894-1', 'auto');
        ga('send', 'pageview');
    </script>


 <script id="dsq-count-scr" src="//davidebarranca.disqus.com/count.js" async></script>

    </body>
</html>