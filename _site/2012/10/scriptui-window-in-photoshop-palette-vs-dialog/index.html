<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ScriptUI Window in Photoshop – Palette vs. Dialog | Davide Barranca &mdash; Photoshop, etc. </title>
    <meta property="og:title" content="ScriptUI Window in Photoshop – Palette vs. Dialog | Davide Barranca &mdash; Photoshop, etc. " />
    <meta name="twitter:title" content="ScriptUI Window in Photoshop – Palette vs. Dialog | Davide Barranca &mdash; Photoshop, etc. " />

    <meta name="description" content="Photoshop implementation of ScriptUI windows of type 'dialog' and 'palette'">
    <meta name="description" property="og:description" content="Photoshop implementation of ScriptUI windows of type 'dialog' and 'palette'" />
    <meta name="twitter:description" content="Photoshop implementation of ScriptUI windows of type 'dialog' and 'palette'" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@undavide" />
    
    <meta property="og:url" content="http://localhost:4000/2012/10/scriptui-window-in-photoshop-palette-vs-dialog/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Davide Barranca" />

    <meta name="copyright" content="Copyright by Davide Barranca. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

    <link rel="canonical" href="http://localhost:4000/2012/10/scriptui-window-in-photoshop-palette-vs-dialog/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

    

    
    <script>
      function UnCryptMailto(s) {
        var n = 0;
        var r = "";
        for (var i = 0; i < s.length; i++) {
          n = s.charCodeAt(i);
          if (n >= 8364) {
            n = 128;
          }
          r += String.fromCharCode(n - 1);
        }
        return r;
      }

      function linkTo_UnCryptMailto(s) {
        location.href = UnCryptMailto(s);
      }
    </script>
    
</head>


    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://localhost:4000"><img alt="Avatar" src="/assets/img/io.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Davide Barranca</strong>
            <span class="my-job-title">Photoshop, etc.</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://localhost:4000" >Blog</a>
            
                
            
                
            
                
            
                
                    <a href="http://localhost:4000/courses/" >Courses</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    

    <p class="about-me">Digital Caveman. Photoshop retoucher and script/panels developer. I am also an author, check the Courses page!</p>

    <ul class="socials">
        <li><a href="https://www.facebook.com/undavide"><svg title="facebook" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li><li><a href="https://twitter.com/undavide"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://github.com/undavide"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <!-- WAS: <a href="mailto:davide.barranca@gmail.com">  -->
            <li><a href="javascript:linkTo_UnCryptMailto('nbjmup;ebwjef/cbssbodbAhnbjm/dpn');" title="Drop me an email"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://localhost:4000/feed.xml"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <article class="post single" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-10-28T02:50:22+02:00" itemprop="datePublished">28 Oct, 2012</time></li>
            
                
                <li class="cats">
                    
                        <a href="/categories/Scripting/">Scripting</a>
                    
                </li>
                
            
        </ul>
        <h2 itemprop="name headline">ScriptUI Window in Photoshop – Palette vs. Dialog</h2>
    </header>

    <div class="post-content">
        <p>ExtendScript - one of the scripting languages supported by Creative Suite applications, and the only one cross-platform - has several extra features compared to Javascript. Besides Filesystem access (a notable addition), there’s the ScriptUI component: which allows you to add graphic user interfaces (GUI) to scripts. Photoshop support is dated to CS2, according to the <em>unofficial</em> (yet essential) <a href="http://www.kahrel.plus.com/indesign/scriptui.html" title="ScriptUI for Dummies">ScriptUI for Dummies</a> guide made by Peter Kahrel. As it happens often in scripting CS applications, the implementation of some feature is <em>version and platform dependent</em> - i.e. PS CS5 on PC is different from PS CS6 on Mac. In this post I’m going to focus on one particular aspect of ScriptUI, namely the Window object.</p>

<h2 id="two-of-a-kind">Two of a kind</h2>

<p>Windows can be either <strong>dialogs</strong> or <strong>palettes</strong> (at least in Photoshop). They look and are substantially different.</p>

<h3 id="palettes">Palettes</h3>

<p>Open the ExtendScript ToolKit (ESTK) and run the following code:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">#</span><span class="nx">target</span> <span class="nx">estoolkit</span>
<span class="kd">var</span> <span class="nx">windowResource</span> <span class="o">=</span> <span class="s2">"palette {  </span><span class="err">\</span><span class="s2">
orientation: 'column', </span><span class="err">\</span><span class="s2">
alignChildren: ['fill', 'top'],  </span><span class="err">\</span><span class="s2">
preferredSize:[300, 130], </span><span class="err">\</span><span class="s2">
text: 'ScriptUI Window - palette',  </span><span class="err">\</span><span class="s2">
margins:15, </span><span class="err">\</span><span class="s2">
</span><span class="err">\</span><span class="s2">
sliderPanel: Panel { </span><span class="err">\</span><span class="s2">
  orientation: 'row', </span><span class="err">\</span><span class="s2">
  alignChildren: 'right', </span><span class="err">\</span><span class="s2">
  margins:15, </span><span class="err">\</span><span class="s2">
  text: ' PANEL ', </span><span class="err">\</span><span class="s2">
  st: StaticText { text: 'Value:' }, </span><span class="err">\</span><span class="s2">
  sl: Slider { minvalue: 1, maxvalue: 100, value: 30, size:[220,20] }, </span><span class="err">\</span><span class="s2">
  te: EditText { text: '30', characters: 5, justify: 'left'} </span><span class="err">\</span><span class="s2">
}, </span><span class="err">\</span><span class="s2">
</span><span class="err">\</span><span class="s2">
bottomGroup: Group{ </span><span class="err">\</span><span class="s2">
  cd: Checkbox { text:'Checkbox value', value: true }, </span><span class="err">\</span><span class="s2">
  cancelButton: Button { text: 'Cancel', properties:{name:'cancel'}, size: [120,24], alignment:['right', 'center'] }, </span><span class="err">\</span><span class="s2">
  applyButton: Button { text: 'Apply', properties:{name:'ok'}, size: [120,24], alignment:['right', 'center'] }, </span><span class="err">\</span><span class="s2">
}</span><span class="err">\</span><span class="s2">
}"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Window</span><span class="p">(</span><span class="nx">windowResource</span><span class="p">);</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">bottomGroup</span><span class="p">.</span><span class="nx">cancelButton</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">win</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">};</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">bottomGroup</span><span class="p">.</span><span class="nx">applyButton</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">win</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">};</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span></code></pre></figure>

<p>The result (it runs in ESTK, since the first line is the preprocessing directive <code class="highlighter-rouge">#target estoolkit</code>) is as follows:</p>

<p><img src="/wp-content/uploads/2012/10/ESTK_palette.png" alt="ESTK palette" title="ESTK palette" /></p>

<p>The above is a <strong>palette</strong>, a <strong>non-modal</strong> window. Something that lets you interact <em>either with the window itself</em> (clicking buttons, dragging sliders, etc) <em>and with the host program</em> - here the ESTK (so you can select, say, menu items, other panels, etc.). It’s the Javascript equivalent of Panels and third party Extensions - they show up and wait there, letting you work with Photoshop.</p>

<h3 id="dialogs">Dialogs</h3>

<p>In ESTK run the following code:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">#</span><span class="nx">target</span> <span class="nx">estoolkit</span>
<span class="kd">var</span> <span class="nx">windowResource</span> <span class="o">=</span> <span class="s2">"dialog {  </span><span class="err">\</span><span class="s2">
orientation: 'column', </span><span class="err">\</span><span class="s2">
alignChildren: ['fill', 'top'],  </span><span class="err">\</span><span class="s2">
preferredSize:[300, 130], </span><span class="err">\</span><span class="s2">
text: 'ScriptUI Window - dialog',  </span><span class="err">\</span><span class="s2">
margins:15, </span><span class="err">\</span><span class="s2">
</span><span class="err">\</span><span class="s2">
sliderPanel: Panel { </span><span class="err">\</span><span class="s2">
  orientation: 'row', </span><span class="err">\</span><span class="s2">
  alignChildren: 'right', </span><span class="err">\</span><span class="s2">
  margins:15, </span><span class="err">\</span><span class="s2">
  text: ' PANEL ', </span><span class="err">\</span><span class="s2">
  st: StaticText { text: 'Value:' }, </span><span class="err">\</span><span class="s2">
  sl: Slider { minvalue: 1, maxvalue: 100, value: 30, size:[220,20] }, </span><span class="err">\</span><span class="s2">
  te: EditText { text: '30', characters: 5, justify: 'left'} </span><span class="err">\</span><span class="s2">
}, </span><span class="err">\</span><span class="s2">
</span><span class="err">\</span><span class="s2">
bottomGroup: Group{ </span><span class="err">\</span><span class="s2">
  cd: Checkbox { text:'Checkbox value', value: true }, </span><span class="err">\</span><span class="s2">
  cancelButton: Button { text: 'Cancel', properties:{name:'cancel'}, size: [120,24], alignment:['right', 'center'] }, </span><span class="err">\</span><span class="s2">
  applyButton: Button { text: 'Apply', properties:{name:'ok'}, size: [120,24], alignment:['right', 'center'] }, </span><span class="err">\</span><span class="s2">
}</span><span class="err">\</span><span class="s2">
}"</span>

<span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Window</span><span class="p">(</span><span class="nx">windowResource</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">win</span><span class="p">.</span><span class="nx">bottomGroup</span><span class="p">.</span><span class="nx">cancelButton</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">win</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">};</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">bottomGroup</span><span class="p">.</span><span class="nx">applyButton</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">win</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">};</span>

<span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span></code></pre></figure>

<p>Compared to the first script, there’s little difference (the windowResource string contains <code class="highlighter-rouge">dialog</code> instead of <code class="highlighter-rouge">palette</code>) and the Window looks like this:</p>

<p><img src="/wp-content/uploads/2012/10/ESTK_dialog.png" alt="ESTK dialog" title="ESTK dialog" /></p>

<p>We’re still within ESTK: the red, closing button is disappeared, the titlebar is bigger, but the main difference is that <strong>dialogs</strong> are <strong>modal</strong>: that is, the focus is on them and you <em>can not interact with the host application</em>. If you try to select, say, a menu item the program complains with a beep.</p>

<h2 id="photoshop-support">Photoshop support</h2>

<p>In the ScriptUI for Dummies guide it’s asserted that Photoshop doesn’t support palette windows. While the more hours I spend debugging unwanted behaviors the more I tend to agree with Peter Kahrel, I would personally express the statement as follows:</p>

<blockquote>
  <p>Photoshop supports both dialog and palette Windows; while the former kind’s behavior is consistent with other CS applications, palette implementation in PS is peculiar and version/platform dependent.</p>
</blockquote>

<h3 id="ps-dialogs-implementation">PS dialogs implementation</h3>

<p>It’s basically what you’d expect - a modal window (which aspect depends on the PS version and platform). Yet the behavior is exactly the same no matter what is the combination, PC/Mac - CS5/CS6. In order to test it, just change the first line of the two scripts above:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">#</span><span class="nx">target</span> <span class="nx">photoshop</span></code></pre></figure>

<figure>
	<img src="/wp-content/uploads/2012/10/PS_dialogs.png" />
	<figcaption>First row: Mac CS5, Mac CS6. Second row: PC CS5, PC CS6.</figcaption>
</figure>

<p>One thing to notice is that PC versions have a red X closing button, while Mac versions do not (for some reason, CS5 rendering of the slider bar is thicker compared to CS6).</p>

<h3 id="ps-palettes-implementation">PS palettes implementation</h3>

<p>Here things get “interesting”. First, if you run the palette example with  <code class="highlighter-rouge">#target photoshop</code> you’re not going to see very much. The Window that you expect to see just flashes briefly and disappear. This is what will happen to every Snp*.jsx examples provided alongside with the ESTK application, not just my code. The answer lies in the fact that palettes keep showing <strong>only</strong> if there’s something going on in the script, <strong>they can not stay idle</strong> waiting for the user to do something like modal dialogs do.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// palette same as before</span>
<span class="kd">var</span> <span class="nx">windowResource</span> <span class="o">=</span> <span class="s2">"palette { /* etc... */}"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Window</span><span class="p">(</span><span class="nx">windowResource</span><span class="p">);</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span> <span class="c1">// adds a new document</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">activeDocument</span><span class="p">.</span><span class="nx">activeLayer</span><span class="p">.</span><span class="nx">applyAddNoise</span> <span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="nx">NoiseDistribution</span><span class="p">.</span><span class="nx">GAUSSIAN</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Blurs it 3 times</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">activeDocument</span><span class="p">.</span><span class="nx">activeLayer</span><span class="p">.</span><span class="nx">applyGaussianBlur</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">sleep</span> <span class="p">(</span><span class="mi">2000</span><span class="p">);</span> <span class="c1">// waits 2 seconds</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">refresh</span><span class="p">();</span> <span class="c1">// refreshes PS</span>
<span class="p">}</span></code></pre></figure>

<p>In the above example, after the <code class="highlighter-rouge">win.show()</code> the script is busy creating a new document, applying and blurring some noise just to kill some time. In the meantime, the palette window shows and keep showing; when the script is done with the task, the palette is automatically closed with no need of user interaction whatsoever, nor explicit <code class="highlighter-rouge">win.close()</code>. In order to keep Photoshop busy, I’ve found two working alternatives (because a straight <code class="highlighter-rouge">$.sleep()</code> loop makes PS quite non-responsive) involving the following functions:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// According to the PS Javascript Reference:</span>
<span class="c1">// "Pauses the script while the application refreshes.</span>
<span class="c1">// Use to slow down execution and show the results to</span>
<span class="c1">// the user as the script runs.</span>
<span class="c1">// Use carefully;</span>
<span class="c1">// your script runs much more slowly when using this method."</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">refresh</span><span class="p">();</span>

<span class="c1">// According to one example's comment in the</span>
<span class="c1">// Photoshop Javascript Reference:</span>
<span class="c1">// "A helper function for debugging</span>
<span class="c1">// It also helps the user see what is going on"</span>
<span class="kd">var</span> <span class="nx">waitForRedraw</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">d</span><span class="p">;</span>
  <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActionDescriptor</span><span class="p">();</span>
  <span class="nx">d</span><span class="p">.</span><span class="nx">putEnumerated</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">stringIDtoTypeID</span><span class="p">(</span><span class="s1">'state'</span><span class="p">),</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">stringIDtoTypeID</span><span class="p">(</span><span class="s1">'state'</span><span class="p">),</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">stringIDtoTypeID</span><span class="p">(</span><span class="s1">'redrawComplete'</span><span class="p">));</span>
  <span class="k">return</span> <span class="nx">executeAction</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">stringIDtoTypeID</span><span class="p">(</span><span class="s1">'wait'</span><span class="p">),</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">DialogModes</span><span class="p">.</span><span class="nx">NO</span><span class="p">);</span>
<span class="p">};</span></code></pre></figure>

<p>The comments in the code should be self-explanatory. As far as I know, <code class="highlighter-rouge">waitForRedraw()</code> should work also in earlier PS versions - it’s not documented, it’s just used in one Reference’s demo scripts.</p>

<h3 id="ps-palette-working-example">PS palette working example</h3>

<p>One possible way to implement working palette Windows in Photoshop has the following logic:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">isDone</span><span class="p">,</span> <span class="nx">s2t</span><span class="p">,</span> <span class="nx">waitForRedraw</span><span class="p">,</span> <span class="nx">win</span><span class="p">,</span> <span class="nx">windowResource</span><span class="p">;</span>

<span class="c1">// Shortcut function</span>
<span class="nx">s2t</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stringID</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">app</span><span class="p">.</span><span class="nx">stringIDToTypeID</span><span class="p">(</span><span class="nx">stringID</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">waitForRedraw</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">d</span><span class="p">;</span>
  <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActionDescriptor</span><span class="p">();</span>
  <span class="nx">d</span><span class="p">.</span><span class="nx">putEnumerated</span><span class="p">(</span><span class="nx">s2t</span><span class="p">(</span><span class="s1">'state'</span><span class="p">),</span> <span class="nx">s2t</span><span class="p">(</span><span class="s1">'state'</span><span class="p">),</span> <span class="nx">s2t</span><span class="p">(</span><span class="s1">'redrawComplete'</span><span class="p">));</span>
  <span class="k">return</span> <span class="nx">executeAction</span><span class="p">(</span><span class="nx">s2t</span><span class="p">(</span><span class="s1">'wait'</span><span class="p">),</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">DialogModes</span><span class="p">.</span><span class="nx">NO</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">//sentinel variable</span>
<span class="nx">isDone</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="c1">// palette same as before</span>
<span class="nx">windowResource</span> <span class="o">=</span> <span class="s2">"palette { /* etc... */}"</span><span class="p">;</span>

<span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Window</span><span class="p">(</span><span class="nx">windowResource</span><span class="p">);</span>

<span class="c1">// Button listeners</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">bottomGroup</span><span class="p">.</span><span class="nx">cancelButton</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">isDone</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">bottomGroup</span><span class="p">.</span><span class="nx">applyButton</span><span class="p">.</span><span class="nx">onClick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">isDone</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// don't forget this one!</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">onClose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">isDone</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="k">while</span> <span class="p">(</span><span class="nx">isDone</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">refresh</span><span class="p">();</span> <span class="c1">// or, alternatively, waitForRedraw();</span>
<span class="p">}</span></code></pre></figure>

<p>The key point is the <code class="highlighter-rouge">isDone</code> variable, which is set false at the beginning. After the Window is shown, a while loop keeps checking for this sentinel value and call <code class="highlighter-rouge">app.refresh()</code>, or alternatively <code class="highlighter-rouge">waitForRedraw()</code> in order to keep the palette showing. Instead of an explicit call to <code class="highlighter-rouge">win.close()</code>, it’s a better option to attach to the buttons’ <code class="highlighter-rouge">onClick()</code> functions a sentinel value’s switch to true. This way the while loop breaks and the Window automatically closes.
Mind you, it’s crucial to set <code class="highlighter-rouge">isDone = true</code> even in the <code class="highlighter-rouge">win.onClose()</code> function, otherwise Photoshop will keep evaluating the variable even after the Window has been closed clicking the red dismiss button (see following screenshot) - resulting in some degree of non-responsiveness.</p>

<figure>
	<img src="/wp-content/uploads/2012/10/PS_palettes.png" />
	<figcaption>First row: Mac CS5, Mac CS6. Second row: PC CS5, PC CS6.</figcaption>
</figure>

<p>Few cosmetic differences are present this time too, including the position of the dismiss button (top-left for Mac, top-right for PC). This button is taken into account with the <code class="highlighter-rouge">onClose()</code> function as shown in the code example.</p>

<h2 id="platform-specific-behaviors-aka-bugs">Platform specific behaviors (aka bugs)</h2>

<p>Things are getting weird if you start to compare Mac and PC implementations of ScriptUI windows in Photoshop CS5 and CS6 (the tests on the PC side have been made on a virtualized Window7 system running in Parallels Desktop). It happens that, depending on how you mix platform, version and Window type, you end up with different behaviors (<em>modal</em> and <em>non-modal</em>), as follows:</p>

<p><img src="/wp-content/uploads/2012/10/BehaviorTable.png" alt="Behavior Table" /></p>

<p>While <strong>dialog</strong>’s behavior is nicely uniform between Mac and PC, CS5 and CS6; <strong>palettes</strong> are a fiasco. Mac behavior is always <em>non-modal</em> (as it should be - palettes are non-modal by definition), while PC’s one depends on the Photoshop version and function used. Basically, only CS5 with app.refresh() works as it’s supposed to do, while in CS6 both functions fail. From my personal standpoint, this is a <strong>bug</strong> - and I haven’t found any workaround yet.</p>

<h2 id="conclusions">Conclusions</h2>

<p>To sum up:</p>

<ul>
  <li>Palettes are defined within Creative Suite applications as <em>non-modal</em> Windows that can wait idle.</li>
  <li>The Photoshop implementation misses entirely the “can wait idle” part - palettes keep showing only if there’s some code running in background.</li>
  <li>There’s a workaround to make palettes behave as they’re supposed to do, involving either <code class="highlighter-rouge">app.refresh()</code> or <code class="highlighter-rouge">waitForRedraw()</code> loops and a sentinel variable.</li>
  <li>On Mac the workaround, no matter on CS5 and CS6 or what function is used, makes the palettes <em>non-modal</em> (as they’re supposed to be by definition)</li>
  <li>On PC, only app.refresh() in CS5 returns a <em>non-modal</em> Window - CS6 ones are always <em>modal</em>.</li>
</ul>

<p>Which is quite a pain in the neck, especially if you need your palettes to work as they’re supposed to do in a platform and version independent way.</p>

    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=ScriptUI Window in Photoshop – Palette vs. Dialog&p[summary]=ExtendScript - one of the scripting languages supported by Creative Suite applications, and the only one cross-platform - has several ext...&p[url]=http://localhost:4000/2012/10/scriptui-window-in-photoshop-palette-vs-dialog/" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://localhost:4000/2012/10/scriptui-window-in-photoshop-palette-vs-dialog/&text=ExtendScript - one of the scripting languages supported by Creative Suite applications, and the only one cross-platform - has several ext...&hashtags=ScriptUI," rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://localhost:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
                <li><a href="http://localhost:4000/tag/ScriptUI">ScriptUI</a></li>
                
            </ul>
        </div>
        
    </footer>
</article>


<aside class="comments" role="complementary">
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function () {
            this.page.url = 'http://localhost:4000/2012/10/scriptui-window-in-photoshop-palette-vs-dialog/';
            this.page.identifier = '10/28/2012';
        };
        (function() {
            var d = document, s = d.createElement('script');

            s.src = '//davidebarranca.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
</aside>


            </main>
        </div>

        <script src="http://localhost:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://localhost:4000/assets/js/backtotop.js"></script>
<script src="http://localhost:4000/assets/js/lunr.min.js"></script>
<script src="http://localhost:4000/assets/js/lunr-feed.js"></script>
<script src="http://localhost:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://localhost:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://localhost:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-25716894-1', 'auto');
        ga('send', 'pageview');
    </script>


 <script id="dsq-count-scr" src="//davidebarranca.disqus.com/count.js" async></script>

    </body>
</html>